////////////////////////////////////////////////////////////
// Headers
////////////////////////////////////////////////////////////
#include <Network/SocketHelper.h>

////////////////////////////////////////////////////////////
/// Windows needs some initialization and cleanup to get
/// sockets working properly..
////////////////////////////////////////////////////////////
void SocketHelperInitialize()
{
	WSADATA InitData;
	WSAStartup(MAKEWORD(2,2), &InitData);
}

////////////////////////////////////////////////////////////
/// Clean...
////////////////////////////////////////////////////////////
void SocketHelperCleanup()
{
	WSACleanup();
}

////////////////////////////////////////////////////////////
/// Return the value of the invalid socket
////////////////////////////////////////////////////////////
SocketType InvalidSocket()
{
    return INVALID_SOCKET;
}


////////////////////////////////////////////////////////////
/// Close / destroy a socket
////////////////////////////////////////////////////////////
bool SocketHelperClose(SocketType Socket)
{
    return (closesocket(Socket) != -1);
}


////////////////////////////////////////////////////////////
/// Set a socket as blocking or non-blocking
////////////////////////////////////////////////////////////
void SocketHelperSetBlocking(SocketType Socket, bool Block)
{
    unsigned long Blocking = (Block ? 0 : 1);
    ioctlsocket(Socket, FIONBIO, &Blocking);
}


////////////////////////////////////////////////////////////
/// Get the last socket error status
////////////////////////////////////////////////////////////
enum SocketStatus SocketHelperGetErrorStatus()
{
    switch (WSAGetLastError())
    {
        case WSAEWOULDBLOCK :	return NotReady;
        case WSAECONNABORTED :	return Disconnected;
        case WSAECONNRESET :	return Disconnected;
        case WSAETIMEDOUT :		return Disconnected;
        case WSAENETRESET :		return Disconnected;
        case WSAENOTCONN :		return Disconnected;
        default :				return Error;
    }
}
