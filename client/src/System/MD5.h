#ifndef SYSTEM_MD5_H
#define SYSTEM_MD5_H

////////////////////////////////////////////////////////////
// Headers
////////////////////////////////////////////////////////////
#include <Config.h>

////////////////////////////////////////////////////////////
// MD5 Context struct
////////////////////////////////////////////////////////////
struct MD5Context
{
  UInt32 State[4];		///< State (ABCD)
  UInt32 Count[2];		///< Number of bits, modulo 2^64 (lsb first)
  UInt8  Buffer[64];	///< Input buffer
};

////////////////////////////////////////////////////////////
/// MD5 initialization.
/// Begins an MD5 operation, writing a new context
////////////////////////////////////////////////////////////
void MD5Init(struct MD5Context * Context);

////////////////////////////////////////////////////////////
/// MD5 block update operation. Continues an MD5 message-digest
/// operation, processing another message block, and updating the
/// context
////////////////////////////////////////////////////////////
void MD5Update(struct MD5Context * Context, unsigned char * Input, unsigned int Len);

////////////////////////////////////////////////////////////
/// MD5 finalization. Ends an MD5 message-digest operation, writing the
/// the message digest and zeroizing the context
////////////////////////////////////////////////////////////
void MD5Final(unsigned char Digest[16], struct MD5Context * Context);

////////////////////////////////////////////////////////////
/// Computes the message digest for a specified file
////////////////////////////////////////////////////////////
void MD5File(char * File, unsigned char Digest[16]);

////////////////////////////////////////////////////////////
/// Digests a string and returns the result
////////////////////////////////////////////////////////////
void MD5String(unsigned char * String, unsigned char Digest[16]);

#endif // SYSTEM_MD5_H
