#ifndef CORE_USERS_H
#define CORE_USERS_H

////////////////////////////////////////////////////////////
// Headers
////////////////////////////////////////////////////////////
#include <Config.h>
#include <Network/Protocol.h>
#include <Database/Accounts.h>

////////////////////////////////////////////////////////////
//Member data
////////////////////////////////////////////////////////////
struct UserData
{
	Thread					ThreadData;				///< User thread
	Mutex					MutexData;				///< User mutex
	struct ConnectionData	Connection;				///< User connection data
	bool					Logged;					///< User login status
	char					Name[0x40];				///< Account name
	char					Password[0x40];			///< Account password
	char					Players[0x06][0x20];	///< Account players

	struct UserData*		Next;					///< Next user data
	struct UserData*		Previous;				///< Previous user data
};

struct UserListData
{
	struct UserData*		First;					///< Fisrt user on the list
	struct UserData*		Last;					///< Last user on the list
};

////////////////////////////////////////////////////////////
/// Initialize users data
////////////////////////////////////////////////////////////
bool UsersInitialize();

////////////////////////////////////////////////////////////
/// Destroy all users
////////////////////////////////////////////////////////////
bool UsersDestroy();

////////////////////////////////////////////////////////////
/// Create a user
////////////////////////////////////////////////////////////
struct UserData * UserCreate();

////////////////////////////////////////////////////////////
/// Add user in the list
////////////////////////////////////////////////////////////
void UserAdd(struct UserData * User);

////////////////////////////////////////////////////////////
/// Remove user from the list
////////////////////////////////////////////////////////////
void UserRemove(struct UserData * User);

////////////////////////////////////////////////////////////
/// Check if the user is on the list
////////////////////////////////////////////////////////////
bool UserContains(struct UserData * User);

////////////////////////////////////////////////////////////
/// Wait the thread until the user isn't removed
////////////////////////////////////////////////////////////
void UserWaitUntilRemoved(struct UserData * User);

////////////////////////////////////////////////////////////
/// User protocol parser
////////////////////////////////////////////////////////////
void UserParseData(void * User);

////////////////////////////////////////////////////////////
/// Connect the user
////////////////////////////////////////////////////////////
bool UserConnect(struct UserData * User);

#endif // CORE_USERS_H